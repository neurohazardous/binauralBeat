%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Project: Binaural Beats
%% Script purpose: Statistical testing of the visual analogue scales 
%% Author: Hector D Orozco Perez
%% Contact: hector.dom.orozco@gmail.com
%% License: GNU GPL v3
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

function PrepareData_and_Beeswarms()

%% Manually import data
S01 = [8.21, 8.28, 1.79,5.26,4.95; 6.05,6.42,1.26,4.95,4.81;6.26,4.95,0.53,4.05,5.37; 6.68,5.68,1.05,3.58,4.87; 7.79,5.16,1.26,5.16,4.76];
S01 = S01.';  %Transposition so it would be (E-SAS, Condition)

S02=[6.35,4.21,0.53,7.00,2.55; 1.74,6.42,6.79,6.63,5.03; 3.00,6.95,2.84,7.58,6.70; 3.58,5.11,4.76,5.68,4.57; 3.11,5.42,2.42,7.16,5.34];
S02 = S02.';

S03=[6.81,1.48,4.31,3.72,1.42; 6.49,3.19,3.51,4.66,1.70; 5.32,5.21,2.77,4.04,5.21; 6.12,6.49,3.30,5.50,3.30; 5.74,6.38,3.09,5.21,1.91];
S03 = S03.';

S04=[2.13,0.43,0.69,8.78,0.00; 2.45,0.32,0.32,9.41,0.00; 1.60,1.33,0.64,9.26,0.00; 3.72,0.64,0.43,9.41,0.00; 4.41,0.74,0.64,9.57,0.00];
S04 = S04.';

S05=[1.59,1.91,1.38,2.75,3.83; 2.23,5.13,5.76,5.85,4.04; 2.02,2.75,6.11,2.75,5.43; 2.66,2.77,4.36,5.84,5.16; 1.60,3.81,6.14,3.07,2.55];
S05 = S05.';

S06=[2.53,3.26,1.58,3.05,6.03; 2.95,2.84,2.74,6.74,6.72; 5.84,6.89,6.74,6.58,3.49; 4.21,4.21,6.21,6.53,2.37; 6.63,7.89,8.74,1.26,7.51];
S06 = S06.';

S07=[2.00,1.58,0.84,2.53,2.96; 0.74,2.21,2.84,3.79,3.39; 1.26,1.89,2.84,3.00,3.28; 0.53,2.95,3.79,4.00,3.39; 0.42,3.47,3.37,4.21,4.11];
S07 = S07.';

S08=[2.33,3.28,4.71,4.97,4.79; 6.56,6.63,5.19,3.17,5.00; 2.96,2.75,3.17,2.53,3.62; 6.24,5.93,5.05,7.04,5.64; 7.09,3.92,2.63,5.08,6.81];
S08 = S08.';

S09=[2.17,1.90,3.49,0.85,8.62; 0.95,1.79,1.69,5.19,9.47; 0.53,1.37,1.38,5.26,9.36; 1.16,1.70,1.48,3.92,8.62; 4.26,2.22,0.37,1.89,7.87];
S09 = S09.';

S10=[1.84,3.53,4.11,4.23,6.88; 2.32,3.79,4.79,6.32,6.44; 2.89,3.07,4.69,5.37,7.77; 0.84,2.33,3.21,6.32,8.62; 5.79,6.53,6.21,6.74,3.83];
S10 = S10.';

S11=[1.84,0.00,2.33,2.74,6.17; 0.11,0.21,9.26,8.11,9.10; 0.42,0.11,7.94,7.68,8.88; 6.74,2.95,6.84,3.58,8.99; 1.26,0.89,0.74,6.35,6.81];
S11 = S11.';

S12=[0.74,1.79,2.75,2.01,2.55; 2.01,6.11,6.21,6.32,4.26; 4.23,7.00,6.46,2.74,3.09; 6.58,6.46,6.63,6.37,2.34; 1.58,6.21,3.17,4.68,5.64];
S12 = S12.';

S13=[3.17,2.00,6.16,2.54,6.12; 2.53,3.39,6.74,7.68,8.04; 1.58,3.58,8.53,7.68,7.77; 2.32,6.24,3.58,8.00,8.78; 2.16,6.74,6.74,8.11,5.21];
S13 = S13.';

S14=[1.47,8.32,	0.63,7.79,7.98; 1.68,1.79,4.95,8.53,7.14; 1.68,2.21,4.05,7.05,5.34; 3.79,1.84,1.79,4.00,8.10; 1.58,1.26,1.58,7.02,6.93];
S14 = S14.';

S15=[2.11,3.47,0.84,2.74,6.56; 0.63,0.95,1.37,0.84,7.77; 1.05,1.05,2.37,1.63,7.68; 2.95,0.95,2.21,0.74,6.53; 2.21,2.74,2.86,0.84,6.84];
S15 = S15.';

S16=[2.42,3.58,5.37,5.68,6.21; 6.21,2.74,2.84,2.79,7.42; 5.37,3.47,3.37,2.95,7.62; 4.84,2.84,3.68,3.58,6.53; 2.21,4.21,6.32,5.68,6.53];
S16 = S16.';

STotal = [S01; S02; S03; S04; S05; S06; S07; S08; S09; S10; S11; S12; S13; S14; S15; S16];   %Create "Super variable" with all of the variables

%% PREPARING ANOVA VECTORS

%Prepare ANOVA vector for MR
MR_ANOVA = zeros(16, 6);

%Set participant's number and make this SPSS compatible
for x=0:15
    Part = 1+(5*x);
    num = x+1;
    MR_ANOVA(num,1) = x+1;
    MR_ANOVA(num,2:6) = STotal(Part,:);
end

%Create the csv
save('BB_ESAS_MR.mat', 'MR_ANOVA');
csvwrite('BB_ESAS_MR.csv', MR_ANOVA)

%Prepare ANOVA vector for AD

AD_ANOVA = zeros(16, 6);

%Set participant's number and make this SPSS compatible
for x=0:15
    Part = 5+(5*x);
    num = x+1;
    AD_ANOVA(num,1) = x+1;
    AD_ANOVA(num,2:6) = STotal(Part,:);
end

%Create the csv
save('BB_ESAS_AD.mat', 'AD_ANOVA');
csvwrite('BB_ESAS_AD.csv', AD_ANOVA)


%% Plot Beeswarms

%MR
figure, plotSpread(MR_ANOVA(:,2:6), 'xNames',{'Baseline', 'MBG', 'BBT', 'BBG', 'MBT'}, 'distributionColors',{'k','k', 'k','k', 'k'},  'showMM', 5, 'yLabel', 'Mental Relaxation Score', 'binWidth', 0.09, 'spreadWidth', .6, 'distributionMarkers', 'o');

%AD
figure, plotSpread(AD_ANOVA(:,2:6), 'xNames',{'Baseline', 'MBG', 'BBT', 'BBG', 'MBT'}, 'distributionColors',{'k','k', 'k','k', 'k'},  'showMM', 5, 'yLabel', 'Absorption Depth Score', 'binWidth', 0.09, 'spreadWidth', .6, 'distributionMarkers', 'o');

end

